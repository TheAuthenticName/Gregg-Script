-- Get Config Settings
local Config = {
    Enabled = getgenv().Config.Enabled,
    Settings = {
        ResetOnGregg = getgenv().Config.Settings.ResetOnGregg,
        ResetInYokai = getgenv().Config.Settings.ResetInYokai,
        ResetInOptimalLocations = getgenv().Config.Settings.ResetInOptimalLocations,
        ShowMaterials = getgenv().Config.Settings.ShowMaterials
    },
    AutoConfiguration = {
        Enabled = getgenv().Config.AutoConfiguration.Enabled,
        Key = getgenv().Config.AutoConfiguration.Key,
    },
    WebhookSettings = {
        Enabled = getgenv().Config.WebhookSettings.Enabled,
        DisplayName = getgenv().Config.WebhookSettings.DisplayName,
        Url = getgenv().Config.WebhookSettings.Url
    }
}

-- Disable Script if disabled
if Config.Enabled == false then
    print("Script Disabled")
    return
else
    print("Script Enabled")
end

-- Material table
local Materials = {
    ["Astral Amethyst"] = 0,
    ["Gold Bar"] = 0,
    ["Obsidian Chunk"] = 0,
    ["Warforged Metal"] = 0
}

-- Material Maps
local AmethystMaps = {"Yokai Peak", "Aquatic Temple", "Ghastly Harbor", "King's Castle"}
local GoldMaps = {"Gilded Skies", "Volcanic Chambers", "The Canals", "Pirate Island"}
local ObsidianMaps = {"Northern Lands", "Orbital Outpost", "Samurai Palace", "Winter Outpost"}
local MetalMaps = {"Enchanted Forest", "Steampunk Sewers", "Underworld", "Desert Temple"}

-- Services
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")

-- Variables
local Player = Players.LocalPlayer
local PlayerGui = Player.PlayerGui

local dungeon
local dungeonName

local Amount
local Material
local Total

local Json

-- Functions
local function WriteData()
    Json = HttpService:JSONEncode(Materials)
    writefile("GreggTracker/Config.json", Json)
end

local function ReadData()
    
end

local function Readmaterials()
    for index, value in pairs(Materials) do
        print(`{index}: {value}`)
    end
end

-- Lobby Shit
if game.PlaceId == 2414851778 then
    local CraftingMenu = PlayerGui:WaitForChild("CraftingUI"):WaitForChild("Main"):WaitForChild("Topbar")

    task.wait(3)

    for index, value in pairs(Materials) do
        Materials[index] = tonumber(CraftingMenu:FindFirstChild(index).TextLabel.Text)
    end

    Readmaterials()

    if not isfolder("GreggTracker") then
        warn("No folder found, Creating one!")
        makefolder("GreggTracker")
    else
        warn("Found folder!")
    end

    if not isfile("GreggTracker/Config.json") then
        warn("No config file found, Creating one!")
        WriteData()
    else
        warn("Found config file!")
        WriteData()
    end
end

-- Dungeon Shit
if game.PlaceId == 14363263080 then
    
end

print("Loaded")
